# Task 8 (Docker and AWS Elastic Beanstalk)

## Prerequisites

---

- The task is a continuation of **Homework 7** and should be done in the same repo
- Create your own copy of [Cart API template repository](https://github.com/boale/rs-cart-api)
- [AWS EB CLI](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-install.html) must be installed
- [Docker](https://docs.docker.com/get-docker/) must be installed

## Tasks

---

### Task 8.1

Create Dockerfile that will build a docker image to run the service. You can use the example provided in the lecture as a starting point. Then, do following steps:

- Add **.dockerignore** file to minimize build context. Files and folders generated by the application or npm should be excluded. Provide explanations to why the folder was ignored.
- OPTIONAL: add more folders to **.dockerignore** with explanations
- Minimize docker image size by applying techniques found in the lecture to be **less than 500 MB**.
- OPTIONAL: Minimize docker image size to **about 100 MB**.
- Optimize image build times. Dockerfile commands that run npm install should not depend on typescript files.
- OPTIONAL: Optimize build times by utilizing multistage builds.
- OPTIONAL: **Lint** Dockerfile.

### Task 8.2

Deploy Cart API service with Elastic Beanstalk.

- **Use** a **Dockerfile** from **TASK 8.1** to deploy your Cart API using AWS EB CLI.
- **Initiate** an Elastic beanstalk application using the eb init command. Application name must follow the following convention {yours_github_account_login}-cart-api.
- **Create a new environment** using the **_eb create_** command. An environment name must be short **but not less then four signs** (e.g _develop_, _test_, _prod_, etc). Use the **_--cname_** option **{yours_github_account_login}-cart-api-{environment_name}** so that Elastic Beanstalk will use it to create a proper domain name. Use the _**--singe**_ option to not use any Load Balancer for this environment.
- **Investigate** AWS Elastic Beanstalk service in the AWS Console. **Walk through** EC2 resources that were created by Elastic Beanstalk
- **Update** the app and deploy changes using the **_eb deploy_** command.
- **Update FE app**: pull the latest version of the app from repo and replace **{cart}** API placeholder in _src/constants/apiPaths.ts_ using a Cart API url you get after successful deployment. Make sure your app starts to call Cart API when you add or remove items. Now after page refresh cartâ€™s content might remain the same.

### Task 8.3

**Save your work (for Rolling Scopes Application only)**

1. Commit all your work to separate branch (e.g. `task-8`) in your own repository.
2. Create a pull request to the `master` branch.
3. Submit link to the pull request to Crosscheck page in [RS App](https://app.rs.school).

## Evaluation criteria (each mark includes previous mark criteria)

---

- **1** - Dockerfile is prepared, image is building. Image size is minimized to be less than 500 MB.
- **2** - Dockerfile is optimized. Files that change more often and commands that depend on them should be included later, files and commands that change less should be at the top.
- **3** - Folders are added to .dockerignore, with explanations. At least 2 big directories should be excluded from build context. Elastic Beanstalk application is initialized.
- **4** - Environment is created and the app is deployed to the AWS cloud. You must provide a link to your GitHub repo with Cart API service or PR with created Dockerfile and related configurations.
- **5** - FE application is updated with Cart API endpoint. You must provide a PR with updates in your FE repository and OPTIONALLY link to deployed front-end app which makes proper API calls to your Cart service.

## Description Teamplate for PRs (for Rolling Scopes Application only)

---

The follwoing should be present in PR's description field:

1. What was done?

   Example:

```
   Service is done, but FE is not working...

   Additional scope - webpack, swagger, unit tests
```

2. Link to product-service API - .....
3. Link to FE PR (YOUR OWN REPOSITORY) - ...

4. In case SWAGGER file is not provided - please provide product schema in PR description
